new class{constructor(){document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".apf-filter").forEach((e=>{e.addEventListener("change",(e=>{this.formHandler(e)}))})),document.querySelectorAll(".apf-page").forEach((e=>{e.addEventListener("click",(e=>{this.paginationHandler(e)}))})),this.filterObserver()}))}filterObserver(){let e=new MutationObserver((e=>{document.querySelectorAll(".apf-page").forEach((e=>{e.addEventListener("click",(e=>{this.paginationHandler(e)}))}))}));document.querySelectorAll(".apf-response").forEach((t=>{e.observe(t,{childList:!0,subtree:!0,characterDataOldValue:!0})}))}formHandler(e){e.preventDefault();let t=e.target,a=(t.value,t.closest("form")),n=a.dataset.filter,o=a.nextElementSibling;o.style.opacity=".5";let r=this.getCategories(a),l=new FormData;l.append("action","afp_get_posts"),l.append("nonce",apf.nonce),l.append("id",n),l.append("categories",r);const c=apf.ajax_url;fetch(c,{method:"post",body:l}).then((e=>e.json())).then((e=>{o.innerHTML=e.data.content})).catch((e=>{console.log(e)})).finally((()=>{o.style.opacity="1"}))}paginationHandler(e){e.preventDefault();let t=e.target,a=t.dataset.page,n=t.closest(".apf-response");n.style.opacity=".5";let o=n.previousElementSibling,r=o.dataset.filter,l=this.getCategories(o),c=new FormData;c.append("action","afp_get_posts"),c.append("nonce",apf.nonce),c.append("id",r),c.append("page",a),c.append("categories",l);const s=apf.ajax_url;fetch(s,{method:"post",body:c}).then((e=>e.json())).then((e=>{n.innerHTML=e.data.content})).catch((()=>{console.log("error")})).finally((()=>{n.style.opacity="1"}))}getCategories(e){let t=[];return e.querySelectorAll("input:checked").forEach((e=>{t.push(e.value)})),0===t.length?t=[]:t}};