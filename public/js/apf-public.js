new class{constructor(){document.addEventListener("DOMContentLoaded",(()=>{document.querySelector(".apf-filter").addEventListener("change",(e=>{this.formHandler(e)})),document.querySelectorAll(".apf-page").forEach((e=>{e.addEventListener("click",(e=>{this.paginationHandler(e)}))})),this.filterObserver()}))}filterObserver(){let e=document.querySelector(".apf-response");new MutationObserver((e=>{document.querySelectorAll(".apf-page").forEach((e=>{e.addEventListener("click",(e=>{this.paginationHandler(e)}))}))})).observe(e,{childList:!0,subtree:!0,characterDataOldValue:!0})}formHandler(e){e.preventDefault();let t=document.querySelector(".apf-response");t.style.opacity=".5";let a=e.target,n=(a.value,a.closest("form")),o=n.dataset.filter,r=this.getCategories(n),c=new FormData;c.append("action","afp_get_posts"),c.append("nonce",apf.nonce),c.append("id",o),c.append("categories",r);const l=apf.ajax_url;fetch(l,{method:"post",body:c}).then((e=>e.json())).then((e=>{t.innerHTML=e.data.content})).catch((e=>{console.log(e)})).finally((()=>{t.style.opacity="1"}))}paginationHandler(e){e.preventDefault();let t=document.querySelector(".apf-response");t.style.opacity=".5";let a=document.querySelector(".apf-filter"),n=a.dataset.filter,o=this.getCategories(a),r=e.target.dataset.page,c=new FormData;c.append("action","afp_get_posts"),c.append("nonce",apf.nonce),c.append("id",n),c.append("page",r),c.append("categories",o);const l=apf.ajax_url;fetch(l,{method:"post",body:c}).then((e=>e.json())).then((e=>{t.innerHTML=e.data.content})).catch((()=>{console.log("error")})).finally((()=>{t.style.opacity="1"}))}getCategories(e){let t=[];return e.querySelectorAll("input:checked").forEach((e=>{t.push(e.value)})),0===t.length?t=[]:t}};